(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{203:function(e,t,n){e.exports=n(358)},212:function(e,t,n){},358:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(37),o=n.n(c),u=n(17),s=(n(212),n(8)),l=n.n(s),i=function(e,t){return function(n){return l.a.async(function(a){for(;;)switch(a.prev=a.next){case 0:n({type:"ERROR",data:e}),setTimeout(function(){return n({type:"EMPTY"})},t+"00");case 2:case"end":return a.stop()}})}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"EMPTY":return"";case"ERROR":return t.data;default:return e}},d=n(27),f=n.n(d),m=function(e){var t;return l.a.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.a.awrap(f.a.post("/api/login",e));case 2:return t=n.sent,n.abrupt("return",t.data);case 4:case"end":return n.stop()}})},E=function(){return function(e){return l.a.async(function(t){for(;;)switch(t.prev=t.next){case 0:null,e({type:"LOGOUT",data:null});case 2:case"end":return t.stop()}})}},v=function(e){return function(t){return l.a.async(function(n){for(;;)switch(n.prev=n.next){case 0:t({type:"SETUSER",data:e});case 1:case"end":return n.stop()}})}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SETUSER":case"LOGOUT":return t.data;default:return e}},g=n(92),y=function(e){var t=Object(a.useState)(""),n=Object(g.a)(t,2),r=n[0],c=n[1];return{type:e,value:r,onChange:function(e){c(e.target.value)},reset:function(e){c("")}}},b=n(44),w=n(366),x=n(372),T=Object(u.b)(function(e){return{notification:e.notification,error:e.error}})(function(e){var t=e.notification,n=e.error;return""!==n?r.a.createElement(w.a,null,n&&r.a.createElement(x.a,{error:!0}," ",n," ")):r.a.createElement(w.a,{style:{paddingTop:"20px"}},t&&r.a.createElement(x.a,{success:!0}," ",t," "))}),O=n(368),I=n(367),k=n(359),C=Object(b.f)(function(e){var t=y("text"),n=y("text");return r.a.createElement(w.a,null,r.a.createElement(w.a,null,"Login: user, Password: password"),r.a.createElement(T,null),r.a.createElement(O.a,{onSubmit:function(a){var r,c;return l.a.async(function(o){for(;;)switch(o.prev=o.next){case 0:return a.preventDefault(),o.prev=1,r={username:t.value,password:n.value},o.next=5,l.a.awrap(m(r));case 5:c=o.sent,window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(c)),e.history.push("/"),e.setUser(c.username),o.next=14;break;case 11:o.prev=11,o.t0=o.catch(1),e.error(o.t0.response.data.error,30);case 14:case"end":return o.stop()}},null,null,[[1,11]])}},r.a.createElement(O.a.Field,null,r.a.createElement(I.a,Object.assign({focus:!0,placeholder:"Enter username"},t))),r.a.createElement(O.a.Field,null,r.a.createElement(I.a,Object.assign({focus:!0,placeholder:"Enter password"},n))),r.a.createElement(k.a,{type:"submit",color:"violet"},"Login")))}),P={error:i,setUser:v},N=Object(u.b)(null,P)(C),j=n(23),S=n(370),_=n(93),A=n(91),L="http://localhost:3003/api/posts",U=null,R={getAll:function(){var e;return l.a.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.awrap(f.a.get(L));case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}})},create:function(e){var t,n;return l.a.async(function(a){for(;;)switch(a.prev=a.next){case 0:return t={headers:{Authorization:U}},a.next=3,l.a.awrap(f.a.post(L,e,t));case 3:return n=a.sent,a.abrupt("return",n.data);case 5:case"end":return a.stop()}})},updateLikes:function(e){var t,n,a,r;return l.a.async(function(c){for(;;)switch(c.prev=c.next){case 0:return t={headers:{Authorization:U}},n="".concat(L,"/").concat(e.id),a=Object(_.a)({},e,{likes:e.likes+1}),c.next=5,l.a.awrap(f.a.put(n,a,t));case 5:return r=c.sent,c.abrupt("return",r.data);case 7:case"end":return c.stop()}})},updatePost:function(e,t){var n,a;return l.a.async(function(r){for(;;)switch(r.prev=r.next){case 0:return n={headers:{Authorization:U}},r.next=3,l.a.awrap(f.a.put("".concat(L,"/").concat(e),t,n));case 3:return a=r.sent,r.abrupt("return",a.data);case 5:case"end":return r.stop()}})},remove:function(e){var t,n,a;return l.a.async(function(r){for(;;)switch(r.prev=r.next){case 0:return t={headers:{Authorization:U}},n="".concat(L,"/").concat(e.id),r.next=4,l.a.awrap(f.a.delete(n,t));case 4:return a=r.sent,r.abrupt("return",a.data);case 6:case"end":return r.stop()}})},setToken:function(e){U="bearer ".concat(e)}},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_POSTS":return t.data;case"DELETE":var n=t.data;return e.filter(function(e){return e.id!==n.id});case"NEW_POST":return[].concat(Object(A.a)(e),[t.data]);case"UPDATE":var a=t.data;return e.map(function(e){return e.id!==a.id?e:a});case"LIKE":var r=t.data.id,c=e.find(function(e){return e.id===r}),o=Object(_.a)({},c,{likes:c.likes+1});return e.map(function(e){return e.id!==r?e:o});default:return e}},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LIKE_NOTIFICATION":return"You liked post '"+t.data+"'";case"DELETE_NOTIFICATION":return"You deleted post '"+t.data+"'";case"UPDATE_NOTIFICATION":return"You updated post '"+t.data+"'";case"EMPTY":return"";case"NEWPOST_NOTIFICATION":return"You created new post '"+t.data+"'";default:return e}},D=n(374),z={createPost:function(e){return function(t){var n;return l.a.async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.a.awrap(R.create(e));case 2:n=a.sent,t({type:"NEW_POST",data:n});case 4:case"end":return a.stop()}})}},updatePost:function(e,t){return function(n){var a;return l.a.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,l.a.awrap(R.updatePost(e,t));case 2:a=r.sent,n({type:"UPDATE",data:a});case 4:case"end":return r.stop()}})}},newPost_notify:function(e,t){return function(n){return l.a.async(function(a){for(;;)switch(a.prev=a.next){case 0:n({type:"NEWPOST_NOTIFICATION",data:e}),setTimeout(function(){return n({type:"EMPTY"})},t+"00");case 2:case"end":return a.stop()}})}},updatePost_notify:function(e,t){return function(n){return l.a.async(function(a){for(;;)switch(a.prev=a.next){case 0:n({type:"UPDATE_NOTIFICATION",data:e}),setTimeout(function(){return n({type:"EMPTY"})},t+"00");case 2:case"end":return a.stop()}})}},error:i},Y=Object(u.b)(null,z)(function(e){var t=e.title,n=e.author,a=e.url,c=function(e){var t,n;return l.a.async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.a.awrap(R.getAll());case 2:return t=a.sent,a.next=5,l.a.awrap(t.find(function(t){return void 0!==t?t.title===e:void 0}));case 5:return n=a.sent,a.abrupt("return",n);case 7:case"end":return a.stop()}})},o=function(t){return l.a.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,l.a.awrap(e.createPost(t));case 3:e.newPost_notify(t.title,50),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),e.error(n.t0.response.data.error,50);case 9:case"end":return n.stop()}},null,null,[[0,6]])},u=function(t,n){return l.a.async(function(a){for(;;)switch(a.prev=a.next){case 0:if(!window.confirm("".concat(t.title," already exists. Do you want to replace it?"))){a.next=10;break}return a.prev=1,a.next=4,l.a.awrap(e.updatePost(t.id,n));case 4:e.updatePost_notify(n.title,50),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(1),e.error(a.t0.response.data.error,50);case 10:case"end":return a.stop()}},null,null,[[1,7]])};return r.a.createElement(w.a,null,r.a.createElement(D.a,{size:"medium"},"Create new post"),r.a.createElement(O.a,{onSubmit:function(e){var t,n;return l.a.async(function(a){for(;;)switch(a.prev=a.next){case 0:return e.preventDefault(),console.log(e.target),t={title:e.target.title.value,author:e.target.author.value,url:e.target.url.value,likes:0},e.target.title.value="",e.target.author.value="",e.target.url.value="",a.next=8,l.a.awrap(c(t.title));case 8:void 0===(n=a.sent)?o(t):u(n,t);case 10:case"end":return a.stop()}})},id:"addForm"},r.a.createElement(O.a.Field,null,r.a.createElement(I.a,Object.assign({name:"title",placeholder:"Enter title"},t))),r.a.createElement(O.a.Field,null,r.a.createElement(I.a,Object.assign({name:"author",placeholder:"Enter author"},n))),r.a.createElement(O.a.Field,null,r.a.createElement(I.a,Object.assign({name:"url",placeholder:"Enter URL"},a))),r.a.createElement(k.a,{type:"submit",color:"violet"},"Add")))}),W=r.a.forwardRef(function(e,t){var n=Object(a.useState)(!1),c=Object(g.a)(n,2),o=c[0],u=c[1],s={display:o?"none":""},l={display:o?"":"none"},i=function(){u(!o)};return r.a.createElement(w.a,{style:{paddingTop:"20px"}},r.a.createElement(w.a,{style:s},r.a.createElement(k.a,{color:"violet",onClick:i},e.buttonLabel)),r.a.createElement(w.a,{style:l,className:"togglableContent"},e.children,r.a.createElement(k.a,{color:"red",onClick:i,style:{marginTop:"10px"}},"Cancel")))}),B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FILTER":return t.filter;default:return e}},J={filterChange:function(e){return{type:"SET_FILTER",filter:e}}},G=Object(u.b)(function(e){return{filter:e.filter}},J)(function(e){return r.a.createElement(I.a,{style:{paddingTop:"20px"},placeholder:"Search",onChange:function(t){e.filterChange(t.target.value)},value:e.filter})}),K=function(e){var t=e.posts,n=e.filter;return void 0!==n?t.filter(function(e){return e.title.toLowerCase().includes(n.toLowerCase())}):t},H=Object(u.b)(function(e){return{visiblePosts:K(e)}},null)(function(e){return r.a.createElement(w.a,null,r.a.createElement(W,{buttonLabel:"New Post"},r.a.createElement(Y,null)),r.a.createElement(G,null),r.a.createElement(S.a,{striped:!0,celled:!0},r.a.createElement(S.a.Body,null,e.visiblePosts.map(function(e){return r.a.createElement(S.a.Row,{key:e.id},r.a.createElement(S.a.Cell,null,r.a.createElement(j.b,{to:"/posts/".concat(e.id)},e.title)),r.a.createElement(S.a.Cell,null,e.user.username))}))))}),q=Object(b.f)(function(e){return r.a.createElement(k.a,{onClick:function(t){var n;return l.a.async(function(a){for(;;)switch(a.prev=a.next){case 0:return t.preventDefault(),a.prev=1,a.next=4,l.a.awrap(e.logout());case 4:n=a.sent,window.localStorage.removeItem("loggedBlogAppUser",JSON.stringify(n)),e.setUser(null),e.history.push("/login"),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(1),e.error(a.t0,30);case 13:case"end":return a.stop()}},null,null,[[1,10]])},color:"violet"},"Log out")}),Q=Object(u.b)(null,{logout:E,setUser:v})(q),V=n(373),X=Object(u.b)(null,null)(function(e){return r.a.createElement("div",null,r.a.createElement(V.a,{inverted:!0,color:"green"},r.a.createElement(V.a.Item,{link:!0},r.a.createElement(j.b,{to:"/"},"Home")),r.a.createElement(V.a.Item,{link:!0},r.a.createElement(j.b,{to:"/users"},"Users")),r.a.createElement(V.a.Menu,{position:"right"},r.a.createElement(V.a.Item,{link:!0},e.user?r.a.createElement("em",null,e.user," logged in ",r.a.createElement(Q,null)):r.a.createElement(j.b,{to:"/login"},"login")))))}),Z=Object(u.b)(function(e){return{users:e.users}},null)(function(e){return r.a.createElement(S.a,{striped:!0,celled:!0},r.a.createElement(S.a.Body,null,r.a.createElement(S.a.Row,null,r.a.createElement(S.a.Cell,null,"Name"),r.a.createElement(S.a.Cell,null,"No of posts")),e.users.map(function(e){return r.a.createElement(S.a.Row,{key:e.id},r.a.createElement(S.a.Cell,null,r.a.createElement(j.b,{to:"/users/".concat(e.id)},e.username)),r.a.createElement(S.a.Cell,null,e.posts.length))})))}),$=n(371),ee=Object(u.b)(null,null)(function(e){return void 0===e.user?null:r.a.createElement(w.a,null,r.a.createElement(D.a,{size:"large",style:{paddingTop:"30px"}},e.user.username),r.a.createElement(D.a,{size:"medium"},"Added blogs"),r.a.createElement($.a,null,e.user.posts.map(function(e){return r.a.createElement($.a.Item,{key:e.id},r.a.createElement(j.b,{to:"/posts/".concat(e.id)},e.title))})))}),te=function(e){var t,n;return l.a.async(function(a){for(;;)switch(a.prev=a.next){case 0:return t="".concat("http://localhost:3003/api/posts","/").concat(e,"/comments"),a.next=3,l.a.awrap(f.a.get(t));case 3:return n=a.sent,a.abrupt("return",n.data);case 5:case"end":return a.stop()}})},ne=function(e){var t,n,a;return l.a.async(function(r){for(;;)switch(r.prev=r.next){case 0:return t={headers:{Authorization:R}},n="".concat("http://localhost:3003/api/posts","/").concat(e.postId,"/comments"),r.next=4,l.a.awrap(f.a.post(n,e,t));case 4:return a=r.sent,r.abrupt("return",a.data);case 6:case"end":return r.stop()}})},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_COMMENTS":return t.data;case"NEW_COMMENT":return[].concat(Object(A.a)(e),[t.data]);default:return e}},re={addComment:function(e){return function(t){var n;return l.a.async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.a.awrap(ne(e));case 2:n=a.sent,t({type:"NEW_COMMENT",data:n});case 4:case"end":return a.stop()}})}}},ce=Object(u.b)(function(e){return{comments:e.comments}},re)(function(e){var t=e.comments,n=e.postId;return r.a.createElement(w.a,{style:{paddingTop:"30px"}},r.a.createElement(D.a,null,"Comments"),r.a.createElement($.a,null,e.comments.filter(function(e){return n===e.postId}).map(function(e){return r.a.createElement($.a.Item,{key:e.id},e.text)})),r.a.createElement(O.a,{onSubmit:function(t){var a;return l.a.async(function(r){for(;;)switch(r.prev=r.next){case 0:return t.preventDefault(),a={postId:n,text:t.target.comment.value},t.target.comment.value="",r.prev=3,r.next=6,l.a.awrap(e.addComment(a));case 6:r.next=11;break;case 8:r.prev=8,r.t0=r.catch(3),e.error(r.t0.response.data.error,30);case 11:case"end":return r.stop()}},null,null,[[3,8]])}},r.a.createElement(w.a,null,r.a.createElement(I.a,Object.assign({name:"comment",placeholder:"Write your comment:"},t.text))),r.a.createElement(w.a,{style:{marginTop:"10px"}},r.a.createElement(k.a,{type:"submit",color:"violet"},"Add comment"))))}),oe=n(41),ue=n(67),se=function(e){return r.a.createElement(k.a,{style:{marginTop:"10px"},value:e.post.id,onClick:e.deletePost,color:"red"},"Remove")},le=Object(b.f)(function(e){var t=e.post,n=e.user;return void 0===e.post?null:r.a.createElement(w.a,null,r.a.createElement(D.a,{size:"large"},"Author: ",t.title),r.a.createElement(w.a,null,"Author: ",t.author),r.a.createElement("a",{href:t.url,rel:"noopener noreferrer",target:"_blank"}," ","Read more"),r.a.createElement(w.a,null,"Created by: ",t.user.username," "),r.a.createElement(k.a,{as:"div",labelPosition:"right",style:{marginTop:"20px"}},r.a.createElement(k.a,{color:"violet",onClick:function(){try{e.updateLikes(t),e.like_notification(t.title,20)}catch(n){e.error(n.response.data.error,30)}}},r.a.createElement(oe.a,{name:"heart"}),"Like"),r.a.createElement(ue.a,{as:"a",basic:!0,color:"violet",pointing:"left"},t.likes)),r.a.createElement(w.a,null,null!==n?r.a.createElement(se,{post:t,deletePost:function(){try{e.history.push("/"),e.deletePost(t),e.delete_notification(t.title,20)}catch(n){console.log(n)}}}):null),r.a.createElement(ce,{postId:t.id}))}),ie={updateLikes:function(e){return function(t){var n;return l.a.async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.a.awrap(R.updateLikes(e));case 2:n=a.sent,t({type:"LIKE",data:n});case 4:case"end":return a.stop()}})}},deletePost:function(e){return function(t){return l.a.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.a.awrap(R.remove(e));case 2:t({type:"DELETE",data:e});case 3:case"end":return n.stop()}})}},like_notification:function(e,t){return function(n){return l.a.async(function(a){for(;;)switch(a.prev=a.next){case 0:n({type:"LIKE_NOTIFICATION",data:e}),setTimeout(function(){return n({type:"EMPTY"})},t+"00");case 2:case"end":return a.stop()}})}},delete_notification:function(e,t){return function(n){return l.a.async(function(a){for(;;)switch(a.prev=a.next){case 0:n({type:"DELETE_NOTIFICATION",data:e}),setTimeout(function(){return n({type:"EMPTY"})},t+"00");case 2:case"end":return a.stop()}})}},error:i},pe=Object(u.b)(null,ie)(le),de=function(){var e;return l.a.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.awrap(f.a.get("http://localhost:3003/api/users"));case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}})},fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_USERS":return t.data;default:return e}},me={initializePosts:function(){return function(e){var t;return l.a.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.a.awrap(R.getAll());case 2:t=n.sent,e({type:"INIT_POSTS",data:t});case 4:case"end":return n.stop()}})}},logout:E,setUser:v,getUsers:function(){return function(e){var t;return l.a.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.a.awrap(de());case 2:t=n.sent,e({type:"GET_USERS",data:t});case 4:case"end":return n.stop()}})}},initComments:function(){return function(e){var t;return l.a.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.a.awrap(te());case 2:t=n.sent,e({type:"INIT_COMMENTS",data:t});case 4:case"end":return n.stop()}})}}},Ee=Object(u.b)(function(e){return{user:e.login,users:e.users,posts:e.posts}},me)(function(e){Object(a.useEffect)(function(){var t=window.localStorage.getItem("loggedBlogAppUser");if(t){var n=JSON.parse(t);R.setToken(n.token),e.setUser(n.username)}e.getUsers(),e.initializePosts(),e.initComments().catch(function(e){console.log(e.message)})},[]);var t=function(){return r.a.createElement("div",null,r.a.createElement(X,{user:e.user}),r.a.createElement(T,null))};return r.a.createElement(w.a,null,r.a.createElement(j.a,null,r.a.createElement(w.a,null,r.a.createElement(w.a,null,""===e.user?r.a.createElement(b.a,{to:"/login"}):r.a.createElement(b.a,{to:"/"}),r.a.createElement(D.a,{size:"large",style:{paddingTop:"30px"}},"Blog posts")),r.a.createElement(b.b,{exact:!0,path:"/",render:function(){return r.a.createElement(w.a,null,r.a.createElement(t,null),r.a.createElement(H,{user:e.user}))}}),r.a.createElement(b.b,{exact:!0,path:"/login",render:function(){return r.a.createElement(N,null)}}),r.a.createElement(b.b,{path:"/users",render:function(){return r.a.createElement(w.a,null,r.a.createElement(t,null),r.a.createElement(Z,{user:e.user}))}}),r.a.createElement(b.b,{path:"/users/:id",render:function(t){var n,a=t.match;return r.a.createElement(ee,{user:(n=a.params.id,e.users.find(function(e){return e.id===n}))})}}),r.a.createElement(b.b,{exact:!0,path:"/posts/:id",render:function(n){var a,c=n.match;return r.a.createElement(w.a,null,r.a.createElement(t,null),r.a.createElement(pe,{post:(a=c.params.id,e.posts.find(function(e){return e.id===a}))}))}}))))}),ve=n(51),he=n(189),ge=n(190),ye=Object(ve.combineReducers)({posts:M,filter:B,notification:F,error:p,login:h,users:fe,comments:ae}),be=Object(ve.createStore)(ye,Object(he.composeWithDevTools)(Object(ve.applyMiddleware)(ge.a)));o.a.render(r.a.createElement(u.a,{store:be},r.a.createElement(Ee,null)),document.getElementById("root"))}},[[203,1,2]]]);
//# sourceMappingURL=main.1225bf8f.chunk.js.map